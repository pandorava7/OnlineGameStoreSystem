@model CreatePostViewModel
@{
    ViewData["Title"] = "Write post";
}

<div class="page-container">
    @* 标题 *@
    <h1 class="page-title"><a href="/Community">Community</a> &gt;&gt; <a href="/community/posts">Post</a> &gt;&gt; Write Your Own Post</h1>

    <div class="post-form-container">
        @* Form() *@
        <form id="postForm" enctype="multipart/form-data" method="post" asp-controller="Community" asp-action="CreatePost">
            @* 隐藏 Id 字段 *@
            <input type="hidden" asp-for="Id" />

            <div class="form-group">
                <label asp-for="Title"></label>
                <input id="title" asp-for="Title" class="form-control" placeholder="Enter title of post" required />
                <span asp-validation-for="Title" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="Thumbnail"></label>
                <div class="thumbnail-upload" onclick="document.getElementById('thumbnail').click();">
                    <input asp-for="Thumbnail" type="file" accept="image/*" id="thumbnail" class="form-control-file" />
                    <p>Click or drag your image</p>
                </div>
                <span asp-validation-for="Thumbnail" class="text-danger"></span>

                @* 隐藏已有缩略图 URL *@
                <input type="hidden" id="thumbnailUrl" asp-for="ThumbnailUrl" />
            </div>


            <div class="form-group">
                <label asp-for="Content"></label>
                <textarea id="content" asp-for="Content" class="form-control" placeholder="Enter content of this post" required></textarea>
                <span asp-validation-for="Content" class="text-danger"></span>
            </div>

            <div class="button-group">
                <button type="submit" class="primary-btn">
                    @(Model.Id == null ? "Upload" : "Save Changes")
                </button>

                @if (Model.Id != null)
                {
                    <button type="submit" class="secondary-btn" onclick="confirmDeletePost()">Delete</button>
                }
            </div>
        </form>

        <!-- 实时预览容器 -->
        <div class="post-preview-container">
            <h1 class="preview-title">Post Preview</h1>

            <div id="postPreview" class="masonry-item">
                <div class="thumbnail-wrapper">
                    <img src="/images/placeholder.png" alt="Preview" class="post-thumbnail" />
                    <div class="view-badge">
                        <i class="fa fa-eye eye-icon"></i>
                        <span>0</span>
                    </div>
                </div>

                <div class="user-info">
                    <div class="avatar-area">
                        <img src="/images/avatar_default.png" class="avatar" />
                    </div>
                    <div class="user-info-right">
                        <div class="username">Your Name</div>
                        <div class="user-line"></div>
                    </div>
                </div>

                <h3 class="post-title"></h3>
                <p class="post-snippet"></p>

                <div class="post-interactions">
                    <span class="like-icon"><i class="fa fa-heart"></i> 0</span>
                    <span class="comment-icon"><i class="fa fa-comment"></i> 0</span>
                </div>
            </div>
        </div>
    </div>
</div>


@section Styles {
    <link rel="stylesheet" href="~/css/pages/publish-post.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/pages/community.css" asp-append-version="true" />
}

@section Scripts {

    <script src="~/js/components/post_preview.js" asp-append-version="true"></script>

}