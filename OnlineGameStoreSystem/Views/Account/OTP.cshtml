@model OnlineGameStoreSystem.Models.ViewModels.ResetPasswordVM;
@{
    ViewData["Title"] = "Verify OTP";
}

<link rel="stylesheet" href="~/css/Account/account.css" asp-append-version="true" />

<div class="login-container">

    <div class="back-text" onclick="history.back()">
        <span class="arrow"><</span>
        <span class="back-word">Back</span>
    </div>

    <h2>Verify OTP</h2>

    <form asp-controller="Account" asp-action="OTP" method="post">

        <div class="form-group">
            <label>Enter the OTP sent to your email</label>
            <input asp-for="OTP" class="form-control" maxlength="6" placeholder="Enter 6-digit OTP" />
            <span asp-validation-for="OTP" style="color:red"></span>
        </div>

        <button type="submit" class="login-btn">Verify</button>


        <div class="resend-box">
            <span style="display:inline-block; margin-top:5px;">Didn't receive the OTP?</span>
            <!-- 不可点击的倒计时按钮 -->
            <span id="countdown" style="color:gray; margin-left:10px;"></span>
            <!-- 可点击的 resend 链接，初始隐藏 -->
            <a id="resendLink" asp-action="ResendOtp" style="display:none; margin-left:10px;">
                Resend OTP
            </a>
        </div>

    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}

<script>
    let seconds = 60; // 60 秒倒计时
    let countdownEl = document.getElementById("countdown");
    let resendLink = document.getElementById("resendLink");

    function startCountdown() {
        countdownEl.innerText = "Resend OTP (" + seconds + "s)";

        let timer = setInterval(() => {
            seconds--;

            if (seconds > 0) {
                countdownEl.innerText = "Resend OTP (" + seconds + "s)";
            } else {
                clearInterval(timer);
                countdownEl.style.display = "none";   // 隐藏倒计时
                resendLink.style.display = "inline";  // 显示 resend 链接
            }
        }, 1000);
    }
    // 页面加载后开始倒计时
    window.onload = startCountdown;
</script>
